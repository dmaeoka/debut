<!-- src/static/sections/hero.liquid -->
{%- if section.settings.hero_layout == 'full_width' and section.settings.hero_size == 'adapt' -%}
	{%- if section.settings.image.aspect_ratio == blank -%}
		{%- assign min_aspect_ratio = 2.0 -%}
	{%- else -%}
		{%- assign min_aspect_ratio = section.settings.image.aspect_ratio -%}
	{%- endif -%}
	{%- assign wrapper_height = 100 | divided_by: min_aspect_ratio -%}
	{%- style -%}
		.hero-{{ section.id }} {
			height: {{- wrapper_height -}}vw !important;
		}
	{%- endstyle -%}
{%- endif -%}

<div data-section-id="{{ section.id }}" data-section-type="hero-section">

	{%- if section.settings.hero_layout == 'fixed_width' -%}
		<div class="container">
	{%- endif -%}

	{%- if section.settings.hero_layout == 'fixed_width' and section.settings.hero_size == 'adapt' -%}
		{%- assign slide_width = 1090 -%}
		{%- assign min_aspect_ratio = section.settings.image.aspect_ratio | default: 2.0 -%}
		<div
			class="relative max-h-screen"
			id="Hero-{{ section.id }}"
			data-layout="{{ section.settings.hero_layout }}"
			data-image-loading-animation>

			{%- assign img_url = section.settings.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
			{%- if section.settings.image.width < max_width -%}
				{%- assign slide_width = section.settings.image.width -%}
			{%- endif -%}

			<div class="absolute top-50 left-0 right-0 z-2" style="transform: translateY(-50%)">
				<div class="container text-center">
					{%- if section.settings.title != blank -%}
						<h2 class="text-shadow text-white font-semibold mb-3{% if section.settings.text_size == 'large' %} text-6xl {% else %} text-4xl{% endif %}">{{ section.settings.title | escape }}</h2>
					{%- endif -%}

					{%- if section.settings.text != blank -%}
						<div class="max-w-lg mx-auto text-shadow text-white{% if section.settings.text_size == 'large' %} text-3xl font-semibold {% else %} text-xl{% endif %}">{{ section.settings.text }}</div>
					{%- endif -%}

					{%- if section.settings.button_label != blank and section.settings.button_link != blank -%}
						<a
							href="{{ section.settings.button_link }}"
							class="bg-red-600 border-transparent btn mt-6 text-white">
							{{ section.settings.button_label | escape }}
						</a>
					{%- endif -%}
				</div>
			</div>
			{%- if section.settings.image != blank -%}
				<img
					class="w-full h-full max-w-full m-auto overflow-hidden lazyload lazypreload"
					data-src="{{ img_url }}"
					data-widths="[180, 360, 470, 600, 770, 970, 1060, 1280, 1512, 1728, 2048]"
					data-aspectratio="{{ section.settings.image.aspect_ratio }}"
					data-sizes="auto"
					style="{%- if slide_width <= max_width -%}
					{%- assign min_width = slide_width | times: 100 | divided_by: max_width -%}
					min-width: {{ min_width }}%;
					{%- endif -%}
					object-fit: cover;
					object-position: {{ section.settings.alignment }};"
					alt="{{ section.settings.image.alt | escape }}">
			{%- else -%}
				<span>
					{% capture current %}{% cycle 1, 2 %}{% endcapture %}
					{{ 'lifestyle-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
				</span>
			{%- endif -%}
			<noscript>
				<div
					class="w-full h-full max-w-full m-auto overflow-hidden"{% if section.settings.image %}{% unless section.settings.image.alt == blank %} role="img" aria-label="{{ section.settings.image.alt | escape }}"{% endunless %}
					style="background-image: url('{{ section.settings.image | img_url: '2048x' }}'); background-position: center {{ section.settings.alignment }};"{% endif %}>
				</div>
			</noscript>
		</div>
	{%- else -%}

		<div
			class="relative flex flex-col bg-cover bg-no-repeat bg-center w-full bg-gray-100 lazyload js
			hero--{{ section.settings.hero_size }}
			hero-{{ section.id }}
			{% if section.settings.title != blank or section.settings.text != blank or section.settings.button_label != blank %} hero__overlay{% endif %}"
			id="Hero-{{ section.id }}"
			data-layout="{{ section.settings.hero_layout }}"
			{%- if section.settings.image -%}
			{% unless section.settings.image.alt == blank %}
			role="img"
			aria-label="{{ section.settings.image.alt | escape }}"
			data-alt="{{ section.settings.image.alt | escape }}"
			{% endunless %}
			data-bg="{{ section.settings.image | img_url: '300x300' }}"
			data-bgset="{% include 'bgset', image: section.settings.image %}"
			data-sizes="auto"
			data-parent-fit="cover"
			style="background-position: {{ section.settings.alignment }};"
			data-image-loading-animation
			{%- endif -%}
		>
		{%- if section.settings.image == blank -%}
			<div class="absolute top-0 right-0 bottom-0 left-0">
				{{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
			</div>
		{%- endif -%}
			<div
				class="relative flex flex-col justify-center py-20 z-2">
				<div class="container text-center">
					{%- if section.settings.title != blank -%}
						<h2 class="text-shadow text-white font-semibold mb-3{% if section.settings.text_size == 'large' %} text-6xl {% else %} text-4xl{% endif %}">{{ section.settings.title | escape }}</h2>
					{%- endif -%}
					{%- if section.settings.text != blank -%}
						<div class="max-w-lg mx-auto text-shadow text-white{% if section.settings.text_size == 'large' %} text-3xl font-semibold {% else %} text-xl{% endif %}">{{ section.settings.text }}</div>
					{%- endif -%}

					{%- if section.settings.button_label != blank and section.settings.button_link != blank -%}
						{%- capture ariaLabel -%}
							{{- section.settings.button_label -}}
							{%- if section.settings.button_link.type == 'frontpage_link' -%}
								: {{ 'homepage.general.title' | t -}}
							{%- elsif section.settings.button_link.type == 'catalog_link' -%}
								: {{ 'collections.catalog.title' | t -}}
							{%- elsif section.settings.button_link.object.title -%}
								: {{ section.settings.button_link.object.title -}}
							{%- endif -%}
						{%- endcapture -%}

						<a
							href="{{ section.settings.button_link }}"
							class="bg-red-600 border-transparent btn mt-6 text-white"
							aria-label="{{ ariaLabel }}">
							{{- section.settings.button_label | escape -}}
						</a>
					{%- endif -%}
				</div>
			</div>
		</div>

		<noscript>
			<div
				class="hero--{{ section.settings.hero_size }}
				{% if section.settings.title != blank or section.settings.text != blank or section.settings.button_label != blank %} hero__overlay{% endif %}"
				{% if section.settings.image %}{% unless section.settings.image.alt == blank %}
				role="img"
				aria-label="{{ section.settings.image.alt | escape }}"{% endunless %}
				style="background-image: url('{{ section.settings.image | img_url: '2048x' }}'); background-position: center {{ section.settings.alignment }};"{% endif %}></div>
		</noscript>
	{%- endif -%}

	{%- if section.settings.hero_layout == 'fixed_width' -%}
		</div>
	{%- endif -%}
</div>

{% schema %}
{
	"name": "Image with text overlay",
	"class": "index-section index-section--flush",
	"settings": [
		{
			"type": "image_picker",
			"id": "image",
			"label": "Image"
		},
		{
			"type": "select",
			"id": "alignment",
			"label": "Image alignment",
			"default": "center",
			"options": [
				{
					"value": "top",
					"label": "Top"
				},
				{
					"value": "center",
					"label": "Middle"
				},
				{
					"value": "bottom",
					"label": "Bottom"
				}
			]
		},
		{
			"type": "select",
			"id": "hero_layout",
			"label": "Layout",
			"default": "full_width",
			"options": [
				{
					"label": "Full width",
					"value": "full_width"
				},
				{
					"label": "Fixed width",
					"value": "fixed_width"
				}
			]
		},
		{
			"type": "select",
			"id": "hero_size",
			"label": "Section height",
			"default": "medium",
			"options": [
				{
					"label": "Adapt to image",
					"value": "adapt"
				},
				{
					"label": "Extra Small",
					"value": "x-small"
				},
				{
					"label": "Small",
					"value": "small"
				},
				{
					"label": "Medium",
					"value": "medium"
				},
				{
					"label": "Large",
					"value": "large"
				},
				{
					"label": "Extra Large",
					"value": "x-large"
				}
			]
		},
		{
			"type": "select",
			"id": "text_size",
			"label": "Text size",
			"default": "medium",
			"options": [
				{
					"label": "Medium",
					"value": "medium"
				},
				{
					"label": "Large",
					"value": "large"
				}
			]
		},
		{
			"type": "text",
			"id": "title",
			"label": "Heading",
			"default": "Image with text overlay"
		},
		{
			"type": "richtext",
			"id": "text",
			"label": "Text",
			"default": "<p>Use overlay text to give your customers insight into your brand. Select imagery and text that relates to your style and story.</p>"
		},
		{
			"type": "text",
			"id": "button_label",
			"label": "Button label"
		},
		{
			"type": "url",
			"id": "button_link",
			"label": "Button link"
		}
	],
	"presets": [
		{
			"name": "Image with text overlay",
			"category": "Image"
		}
	]
}
{% endschema %}
